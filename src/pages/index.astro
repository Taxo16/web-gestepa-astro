---
import Layout from '~/layouts/PageLayout.astro';
import Hero from '~/components/widgets/Hero.astro';
import Features from '~/components/widgets/Features.astro';
import Content from '~/components/widgets/Content.astro';
import Stats from '~/components/widgets/Stats.astro';
import CallToAction from '~/components/widgets/CallToAction.astro';
import Testimonials from '~/components/widgets/Testimonials.astro'; // <--- IMPORTADO NUEVO
import Image from '~/components/common/Image.astro';

// IMPORTS DE IMÁGENES
import heroImage from '~/assets/images/fondo-gestepa.jpeg';

// Imports del Equipo
import anastasioImg from '~/assets/images/personal/ANASTASIO.jpg';
import ireneImg from '~/assets/images/personal/IRENE.jpg';
import joseCarlosImg from '~/assets/images/personal/JOSE CARLOS.jpg';
import martaImg from '~/assets/images/personal/MARTA.jpg';
import nataliaImg from '~/assets/images/personal/NATALIA.jpg';
import patriciaImg from '~/assets/images/personal/PATRICIA.jpg';

const metadata = {
  title: 'GESTEPA | Asesoría Integral para Empresas y Despachos',
  ignoreTitleTemplate: true,
};
---

<Layout metadata={metadata}>
  
  <Hero
    actions={[
      {
        variant: 'primary',
        text: 'CONTACTA AHORA',
        href: '/contact',
        icon: 'tabler:mail',
      },
      {
        text: 'SOLICITA ASESORAMIENTO',
        href: '#servicios',
        class: 'bg-white text-blue-900 hover:bg-blue-50 font-bold',
      },
      {
        text: 'AHORRO ENERGÉTICO',
        href: '/ahorro-energetico',
        icon: 'tabler:bolt',
        class: 'bg-emerald-600 text-white hover:bg-emerald-700 font-bold shadow-lg',
      },
    ]}
  >
    <Fragment slot="title">
      <span class="text-white font-black uppercase tracking-widest text-shadow-gestepa">
        GESTEPA ASESORES
      </span> 
      <br />
      
      <span class="text-blue-200 font-black uppercase tracking-widest text-shadow-gestepa highlight min-h-[1.2em] inline-block pl-4 md:pl-6">
        <span id="typewriter-text"></span>
        <span id="cursor" class="animate-pulse text-white">|</span>
      </span>
    </Fragment>

    <Fragment slot="subtitle">
      <span class="text-white text-lg font-medium text-shadow-gestepa tracking-wide">
        Somos un despacho profesional de <span class="text-blue-200 font-bold">servicios integrales</span>. 
        Ofrecemos soluciones completas a <span class="font-bold text-white uppercase">empresas</span> y soporte técnico especializado a <span class="font-bold text-white uppercase">otras asesorías</span>.
      </span>
    </Fragment>

    <Fragment slot="bg">
      <div class="absolute inset-0 bg-[#1e425e]/30 dark:bg-slate-900/40 z-10"></div>
      <img 
        src={heroImage.src}
        class="absolute inset-0 w-full h-full object-cover -z-10" 
        alt="Oficina Gestepa"
      />
    </Fragment>
  </Hero>

  <Features
    id="features-intro"
    columns={3}
    items={[
      {
        title: 'Servicio Integral',
        description: 'Centraliza laboral, fiscal, jurídico y energía en un único despacho. Evita errores de coordinación.',
        icon: 'tabler:circles-relation',
      },
      {
        title: 'Apoyo a Asesorías',
        description: 'Actuamos como soporte técnico para otros despachos que necesitan reforzar sus servicios.',
        icon: 'tabler:users-group',
      },
      {
        title: 'Ahorro de Costes',
        description: 'Optimizamos tus facturas de luz y gas y ajustamos tus seguros a lo que realmente necesitas.',
        icon: 'tabler:pig-money',
      },
    ]}
  />

  <Content
    id="nosotros"
    isReversed
    tagline="Nuestra Filosofía"
    title="GESTEPA ASESORES"
    items={[
      {
        title: 'Visión Global',
        description:
          'Nuestro equipo trabaja de forma coordinada para anticiparse a problemas en todos los ámbitos de tu empresa.',
      },
      {
        title: 'Seguridad',
        description:
          'Dominamos toda la normativa vigente. Déjate guiar por expertos y evita riesgos innecesarios.',
      },
    ]}
    image={{
      src: 'https://images.unsplash.com/photo-1556761175-5973dc0f32e7?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80',
      alt: 'Reunión GESTEPA',
    }}
  >
    <Fragment slot="content">
      <h3 class="text-2xl font-bold tracking-tight dark:text-white sm:text-3xl mb-2">Un único interlocutor</h3>
      Ofrecemos un servicio integral para la tranquilidad de tu empresa.
    </Fragment>

    <Fragment slot="bg">
      <div class="absolute inset-0 bg-blue-50 dark:bg-transparent"></div>
    </Fragment>
  </Content>

  <Stats
    title="La mejor recompensa a nuestro esfuerzo está en los resultados"
    stats={[
      { title: 'Clientes Satisfechos', amount: '+400' },
      { title: 'Fidelidad', amount: '99%' },
      { title: 'Años de Trayectoria', amount: '+20' },
      { title: 'Profesionales', amount: '12' },
    ]}
  />

  <Features
    id="servicios"
    tagline="Servicios"
    title="CATÁLOGO DE SERVICIOS INTEGRALES"
    subtitle="Si estás buscando ayuda, nosotros sabemos asesorarte con todo detalle."
    items={[
      {
        title: 'Asesoría Laboral',
        description: 'Gestión de contratos, nóminas y seguros sociales con máxima precisión.',
        icon: 'tabler:building-bank',
      },
      {
        title: 'Asesoría Fiscal',
        description: 'Cumplimiento óptimo de impuestos ante la administración tributaria.',
        icon: 'tabler:gavel',
      },
      {
        title: 'Área Contable',
        description: 'Libros oficiales, balances, cuentas anuales y registro mercantil.',
        icon: 'tabler:calculator',
      },
      {
        title: 'Asesoría Jurídica',
        description: 'Soluciones legales en normativas, leyes y defensa jurídica.',
        icon: 'tabler:scale',
      },
      {
        title: 'Ahorro Energético',
        description: 'Estudio gratuito de facturas de luz y gas con más de 40 comercializadoras.',
        icon: 'tabler:bolt', 
      },
      {
        title: 'Extranjería y Vehículos',
        description: 'Gestión de permisos de residencia, trabajo y transferencias de vehículos.',
        icon: 'tabler:world',
      },
    ]}
  />

  <Content
    isReversed
    id="asesorias"
    tagline="Colaboración B2B"
    title="Soporte técnico para otras Asesorías"
    items={[
      {
        title: 'Marca Blanca y Confidencialidad',
        description: 'Nos adaptamos a tu forma de trabajar con absoluta discreción y rigor técnico.',
      },
      {
        title: 'Sin costes fijos',
        description: 'Amplía tu cartera de servicios sin aumentar tu estructura de personal.',
      },
      {
        title: 'Especialización',
        description: 'Actuamos como tu departamento técnico en áreas fiscal, laboral o jurídica.',
      },
    ]}
    image={{
      src: 'https://images.unsplash.com/photo-1552664730-d307ca884978?auto=format&fit=crop&w=2070&q=80',
      alt: 'Colaboración entre asesorías',
    }}
  >
    <Fragment slot="content">
      <h3 class="text-2xl font-bold tracking-tight dark:text-white sm:text-3xl mb-2">
        ¿Eres un despacho profesional?
      </h3>
      Ayudamos a otros despachos a crecer ofreciendo soporte técnico especializado en áreas donde necesitan refuerzo.
    </Fragment>

    <Fragment slot="bg">
      <div class="absolute inset-0 bg-blue-50 dark:bg-transparent"></div>
    </Fragment>
  </Content>

  <Testimonials
    title="Casos de éxito reales"
    subtitle="Resultados comprobables en empresas que confían en nosotros"
    testimonials={[
      {
        testimonial: 'Empresa del sector servicios redujo su factura eléctrica en un 18% tras el estudio energético, manteniendo el mismo consumo y sin cortes en el suministro.',
        name: 'Sector Servicios',
        job: 'Ahorro Energético',
        image: {
          src: 'https://images.unsplash.com/photo-1560179707-f14e90ef3dab?auto=format&fit=crop&w=100&q=80',
          alt: 'Caso de éxito Energía',
        },
      },
      {
        testimonial: 'Autónomo consiguió optimizar su potencia contratada logrando un ahorro de más del 25% anual en su factura de luz gracias a la revisión gratuita.',
        name: 'Autónomo Local',
        job: 'Optimización de Costes',
        image: {
          src: 'https://images.unsplash.com/photo-1633332755192-727a05c4013d?auto=format&fit=crop&w=100&q=80',
          alt: 'Caso de éxito Autónomo',
        },
      },
      {
        testimonial: 'Externalización completa del área laboral para un despacho colaborador, permitiéndoles ampliar su servicio sin aumentar costes fijos.',
        name: 'Asesoría Colaboradora',
        job: 'Soporte B2B',
        image: {
          src: 'https://images.unsplash.com/photo-1556910103-1c02745a30bf?auto=format&fit=crop&w=100&q=80',
          alt: 'Caso de éxito B2B',
        },
      },
    ]}
  />

  <section class="relative not-prose scroll-mt-[72px]" id="equipo">
    <div class="absolute inset-0 pointer-events-none -z-[1]" aria-hidden="true">
      <div class="absolute inset-0 bg-blue-50 dark:bg-transparent"></div>
    </div>
    
    <div class="relative mx-auto max-w-7xl px-4 md:px-6 py-12 md:py-20 lg:py-24 text-default">
      
      <div class="mb-8 md:mx-auto md:mb-12 text-center max-w-3xl">
        <p class="text-base text-secondary dark:text-blue-200 font-bold tracking-wide uppercase">
          Equipo Humano
        </p>
        <h2 class="font-bold leading-tighter tracking-tighter font-heading text-heading text-3xl md:text-4xl">
          Conoce a los expertos detrás de tu tranquilidad
        </h2>
        <p class="mt-4 text-muted text-xl dark:text-slate-400">
          Profesionales titulados, cercanos y comprometidos con tu negocio.
        </p>
      </div>

      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
        {
          [
            // 1. Anastasio
            { 
              name: 'Anastasio', 
              role: 'Director General', 
              img: anastasioImg 
            },
            // 2. José Carlos
            { 
              name: 'José Carlos', 
              role: 'Responsable de Coordinación y Operaciones', 
              img: joseCarlosImg 
            },
            // 3. Natalia Martín
            { 
              name: 'Natalia Martín', 
              role: 'Responsable Área Fiscal y Contable', 
              img: nataliaImg 
            },
            // 4. Irene Prieto
            { 
              name: 'Irene Prieto', 
              role: 'Especialista del Área Laboral', 
              img: ireneImg 
            },
            // 5. Marta Muñoz
            { 
              name: 'Marta Muñoz', 
              role: 'Responsable del Área Laboral', 
              img: martaImg 
            },
            // 6. Silvia Patricia Rueda (Usamos la foto de PATRICIA.jpg)
            { 
              name: 'Silvia Patricia Rueda', 
              role: 'Responsable de Servicios Corporativos', 
              img: patriciaImg 
            },
          ].map((member) => (
            <div class="group flex flex-col items-center bg-white dark:bg-slate-900 rounded-xl shadow-lg p-6 text-center border border-gray-100 dark:border-gray-700 hover:shadow-xl transition duration-300">
              <div class="relative mb-4">
                <div class="w-40 h-40 rounded-full overflow-hidden border-4 border-blue-50 group-hover:border-blue-200 transition duration-300 bg-white shadow-sm flex items-end justify-center">
                    <Image 
                      src={member.img} 
                      alt={member.name} 
                      class="w-full h-full object-contain object-bottom"
                      width={300}
                      height={300}
                    />
                </div>
              </div>
              <h3 class="text-xl font-bold mb-1 text-gray-900 dark:text-white">{member.name}</h3>
              <p class="text-secondary dark:text-blue-400 font-medium uppercase text-sm tracking-wider px-2">{member.role}</p>
            </div>
          ))
        }
      </div>
    </div>
  </section>

  <CallToAction
    actions={[
      {
        variant: 'primary',
        text: 'ACCESO CLIENTES',
        href: 'https://gestepaasesores.bilky.es/auth/login',
        target: '_blank',
        icon: 'tabler:lock',
      },
    ]}
  >
    <Fragment slot="title">
      ¡Solo un click te separa de la mejor solución!
    </Fragment>
    <Fragment slot="subtitle">
      Accede a tu área privada y gestiona tu documentación al instante.
    </Fragment>
  </CallToAction>

  <Hero id="frase">
    <Fragment slot="title">
      <span class="text-3xl md:text-4xl font-serif italic text-gray-700 dark:text-gray-300">
        "El mejor Asesor es el que te indica el mejor camino"
      </span>
    </Fragment>
  </Hero>

  <Content
    isReversed
    title="TECNOLOGÍA MÁS AVANZADA"
    subtitle="Para estar al día de todo lo que le afecta a tu negocio."
    items={[
      {
        title: 'Digitalización',
        description: 'Implementamos las últimas herramientas digitales para agilizar trámites.',
      },
      {
        title: 'Seguridad',
        description: 'Tus datos están protegidos con los mejores sistemas de ciberseguridad.',
      },
    ]}
    image={{
      src: 'https://images.unsplash.com/photo-1460925895917-afdab827c52f?auto=format&fit=crop&w=2015&q=80',
      alt: 'Tecnología GESTEPA',
    }}
  >
    <Fragment slot="bg">
      <div class="absolute inset-0 bg-blue-50 dark:bg-transparent"></div>
    </Fragment>
  </Content>

  <CallToAction
    actions={[
      {
        variant: 'secondary',
        text: 'CONTACTAR AHORA',
        href: '/contact',
        icon: 'tabler:mail',
      },
      {
        text: 'LLAMAR 955 21 15 15',
        href: 'tel:955913370',
        icon: 'tabler:phone',
      }
    ]}
  >
    <Fragment slot="title">
      ¿Necesitas más información?
    </Fragment>
    <Fragment slot="subtitle">
      Estamos aquí para ayudarte. Contacta con nosotros sin compromiso.
    </Fragment>
  </CallToAction>

</Layout>

<script>
  // FRASES ESTRATÉGICAS B2B
  const phrases = [
    "SERVICIO INTEGRAL",
    "PARA EMPRESAS",
    "APOYO A ASESORÍAS",
    "AHORRO ENERGÉTICO"
  ];
  
  const typingSpeed = 100;
  const deletingSpeed = 50;
  const pauseTime = 2000;
  
  let currentPhraseIndex = 0;
  let currentCharIndex = 0;
  let isDeleting = false;
  
  const textElement = document.getElementById('typewriter-text');
  
  function type() {
    if (!textElement) return;

    const currentPhrase = phrases[currentPhraseIndex];
    
    if (isDeleting) {
      textElement.textContent = currentPhrase.substring(0, currentCharIndex - 1);
      currentCharIndex--;
    } else {
      textElement.textContent = currentPhrase.substring(0, currentCharIndex + 1);
      currentCharIndex++;
    }

    let typeSpeed = isDeleting ? deletingSpeed : typingSpeed;

    if (!isDeleting && currentCharIndex === currentPhrase.length) {
      typeSpeed = pauseTime;
      isDeleting = true;
    } else if (isDeleting && currentCharIndex === 0) {
      isDeleting = false;
      currentPhraseIndex = (currentPhraseIndex + 1) % phrases.length;
      typeSpeed = 500;
    }

    setTimeout(type, typeSpeed);
  }

  document.addEventListener('DOMContentLoaded', () => {
    setTimeout(type, 1000);
  });
</script>